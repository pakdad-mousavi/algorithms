import{_ as k}from"./Alert-T-tNcT_w.js";import{e as n,o as l,g,i as v,t as d,p as x,n as B,c as z,f as y,b as _,D as w,F as b,l as h,h as $,d as M}from"./index-Bn_nT_Cx.js";const F={class:"text-center"},A={key:0},j={class:"font-medium"},N={key:1,class:"font-medium"},R={__name:"MemoryBlock",props:{memoryBlock:{type:Object,required:!0},totalMemory:{type:Number,required:!0}},setup(e){const r=t=>t.status==="allocated"?o[t.pid-1]:"border-zinc-700",o=["bg-[image:repeating-linear-gradient(315deg,var(--color-cyan-600)_0,var(--color-cyan-600)_1px,_transparent_1px,_transparent_50%)] border-cyan-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-emerald-600)_0,var(--color-emerald-600)_1px,_transparent_1px,_transparent_50%)] border-emerald-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-yellow-500)_0,var(--color-yellow-500)_1px,_transparent_1px,_transparent_50%)] border-yellow-500 border","bg-[image:repeating-linear-gradient(315deg,var(--color-rose-600)_0,var(--color-rose-600)_1px,_transparent_1px,_transparent_50%)] border-rose-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-amber-600)_0,var(--color-amber-600)_1px,_transparent_1px,_transparent_50%)] border-amber-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-violet-600)_0,var(--color-violet-600)_1px,_transparent_1px,_transparent_50%)] border-violet-600 border"];return(t,a)=>(l(),n("div",{class:B(["flex items-center justify-center h-full border-x bg-[size:10px_10px] last:border-r-0",r(e.memoryBlock)]),style:x(`width: ${e.memoryBlock.size/e.totalMemory*100}%`)},[g("p",F,[e.memoryBlock.status==="allocated"?(l(),n("span",A,[v(" P"+d(e.memoryBlock.pid)+": ",1),g("span",j,d(e.memoryBlock.size)+"KB",1)])):(l(),n("span",N,d(e.memoryBlock.status[0].toUpperCase()+e.memoryBlock.status.slice(1))+": "+d(e.memoryBlock.size)+"KB ",1))])],6))}},S={class:"flex items-center justify-center w-12 h-full bg-zinc-800"},q={key:0},C={key:1},P={__name:"ActionCode",props:{currentAction:{type:Object,required:!0}},setup(e){return(r,o)=>(l(),n("div",S,[e.currentAction.isAllocation?(l(),n("span",q,"A"+d(e.currentAction.pid),1)):(l(),n("span",C,"D"+d(e.currentAction.pid),1))]))}},V={key:0,class:"overflow-x-scroll"},L={class:"flex flex-col gap-y-0.5 overflow-hidden border rounded-md min-w-xl border-zinc-700"},T={__name:"Memory",props:{hasAlgorithmBeenRan:{type:Boolean,required:!0},totalMemory:{type:Number,required:!0},algResult:{type:Object,required:!0},actions:{type:Array,default:()=>[]}},setup(e){const r=e,o=z(()=>{const t=r.actions[r.algResult.memoryLog.length];return t!=null&&t.isAllocation?`Failed to allocate memory to process P${t==null?void 0:t.pid}, not enough memory or memory has already been allocated to this process. Try increasing the total memory, requesting for less memory, or allocating memory to the process once.`:`Failed to deallocate memory from process P${t==null?void 0:t.pid}, process could not be found in memory. Make sure that P${t==null?void 0:t.pid} has been allocated before trying to deallocate it.`});return(t,a)=>(l(),n(b,null,[e.hasAlgorithmBeenRan?(l(),n("div",V,[a[0]||(a[0]=w('<div class="min-w-xl"><div class="w-[calc(100%-48px)] ml-12 text-center relative"><span class="mb-2 block">Memory</span><div class="mb-6 border-b-2 border-zinc-600"></div><div class="absolute h-4 border border-zinc-600 -bottom-4"></div><div class="absolute h-4 border border-zinc-600 right-0 -bottom-4"></div></div></div>',1)),g("div",L,[(l(!0),n(b,null,h(e.algResult.memoryLog,(s,c)=>(l(),n("div",{key:c,class:"border-y border-zinc-700 first:border-t-0 last:border-b-0 flex items-center justify-center w-full h-12 gap-x-0.5"},[$(P,{"current-action":e.actions[c]},null,8,["current-action"]),(l(!0),n(b,null,h(s,(i,m)=>(l(),_(R,{key:m,"memory-block":i,"total-memory":e.totalMemory},null,8,["memory-block","total-memory"]))),128))]))),128))])])):y("",!0),e.hasAlgorithmBeenRan&&!e.algResult.isSuccessful?(l(),_(k,{key:1,"alert-style":"error"},{default:M(()=>[g("p",null,d(o.value),1)]),_:1})):y("",!0)],64))}},f={firstFit:(e,r)=>{for(let o=0;o<r.length;o++){const t=r[o];if(t.status==="free"&&t.size>=e)return[o,t]}return[r.length,!1]},bestFit:(e,r)=>{let o=-1,t=null;for(let a=0;a<r.length;a++){const s=r[a];s.status==="free"&&s.size>=e&&(!t||s.size<t.size)&&(t=s,o=a)}return t?[o,t]:[r.length,!1]},worstFit:()=>{}},D=(e,r,o,t)=>{const a=new Set(o.filter(u=>u.status==="allocated").map(u=>u.pid)),s=f==null?void 0:f[t],[c,i]=s(r,o);if(!i||a.has(e))return!1;const m={start:i.start,size:r,status:"allocated",pid:e},p=i.size-r;if(p){const u={start:i.start+r,size:p,status:"free"};o.splice(c,1,m,u)}else o[c]=m;return!0},O=(e,r)=>{for(let o=0;o<r.length;o++)if(r[o].status==="allocated"&&r[o].pid===e)return r[o]={start:r[o].start,size:r[o].size,status:"free"},K(r),!0;return!1},K=e=>{for(let r=0;r<e.length-1;r++){const o=e[r],t=e[r+1];o.status==="free"&&t.status==="free"&&(e[r].size+=t.size,e.splice(r+1,1),r--)}},U=(e,r,o)=>{const t=[],a=[];let s=!0;t.push({start:0,size:r,status:"free"});for(const c of e)if(c.isAllocation?s=D(c.pid,c.size,t,o):s=O(c.pid,t),s)a.push(t.map(i=>({...i})));else break;return{isSuccessful:s,memoryLog:a}};export{T as _,U as r};
