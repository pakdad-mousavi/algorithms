var U=Object.defineProperty;var j=(a,s,o)=>s in a?U(a,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[s]=o;var I=(a,s,o)=>j(a,typeof s!="symbol"?s+"":s,o);import{h as n,o as l,e,l as u,m as b,q as P,F as m,i as c,p as w,j as z,a as V,r as C,w as N,b as R,u as M,t as $,d as k,f as O,v as q,g as T,k as y,I as H}from"./index-CE2k5yp4.js";import{_ as D,a as F,b as L,T as W}from"./Figure-CHKq4HFN.js";const E={class:"flex flex-col w-full pb-2 space-y-4 overflow-x-scroll"},_={class:"flex flex-wrap justify-center gap-4 sm:justify-normal"},G={class:"px-2 py-1 border rounded-md bg-zinc-800 border-zinc-700 max-w-max"},K={class:"font-medium"},J={class:"hidden sm:block min-w-xl"},Q={class:"flex items-center mb-4"},X={class:"py-2 font-bold border-r border-zinc-700 last:border-0"},Y={class:"flex mb-2"},Z={class:"w-1/6 border-transparent border-y"},ee={class:"py-2 space-y-2 font-medium border-b border-transparent"},te={class:"w-5/6"},se={class:"border-r border-zinc-700 last:border-0"},ae={class:"mx-auto"},re={key:0,class:"flex flex-col items-center font-medium"},le={class:"flex justify-center w-full gap-x-4 sm:hidden"},ne={class:"flex flex-col items-center mb-4"},oe={class:"text-center border rounded-md border-zinc-700"},ie={class:"flex items-center justify-center w-10 font-bold border-b aspect-square border-zinc-700 last:border-0"},de={class:"flex flex-col items-center mb-4"},ue={class:"flex flex-col mb-2"},me={class:"flex justify-around w-full h-24"},ce={class:"font-medium",style:{"writing-mode":"vertical-rl"}},pe={class:"flex"},ge={class:"mb-4 overflow-hidden text-center border rounded-md border-zinc-700"},fe={class:"flex flex-col mt-24"},he={class:"flex items-center h-10 font-medium"},be={key:0,class:"py-0.5 px-2 text-sm bg-rose-800 rounded-md"},xe={__name:"RefStringTracer",props:{frameCount:{type:Number,required:!0},totalPageFaults:{type:Number,required:!0},referenceStr:{type:Array,required:!0},log:{type:Array,required:!0}},setup(a){const s=["bg-yellow-600 text-zinc-900","bg-emerald-700","bg-blue-900","bg-amber-700","bg-purple-700"];return(o,i)=>(l(),n("div",E,[e("div",_,[i[2]||(i[2]=e("div",{class:"sm:flex-1"},[e("p",{class:"px-2 py-1 border rounded-md bg-zinc-800 border-zinc-700 max-w-max"},[e("span",{class:"py-0.5 px-2 text-sm bg-rose-800 rounded-md"},"PF"),e("span",null,": Page Fault")]),e("p")],-1)),e("div",G,[e("p",null,[i[0]||(i[0]=u("Total Page Faults: ")),e("span",K,b(a.totalPageFaults),1)]),i[1]||(i[1]=e("p",null,null,-1))])]),e("div",J,[e("div",Q,[i[3]||(i[3]=e("h4",{class:"w-1/6 font-medium"},"Pages:",-1)),e("ul",{class:"grid w-5/6 text-center border rounded-md border-zinc-700",style:P(`grid-template-columns: repeat(${a.referenceStr.length}, minmax(0, 1fr));`)},[(l(!0),n(m,null,c(a.referenceStr,r=>(l(),n("li",X,b(r),1))),256))],4)]),e("div",Y,[e("div",Z,[(l(!0),n(m,null,c(a.frameCount,r=>(l(),n("div",ee,[e("h4",{class:w(["px-2 rounded-md max-w-max",s[r-1]])}," Frame "+b(String.fromCharCode(r+64))+": ",3)]))),256))]),e("div",te,[e("div",{class:"grid mb-4 overflow-hidden text-center border rounded-md border-zinc-700",style:P(`grid-template-columns: repeat(${a.referenceStr.length}, minmax(0, 1fr));`)},[(l(!0),n(m,null,c(a.log,({frames:r,victimPageFrameIdx:d})=>(l(),n("div",se,[(l(!0),n(m,null,c(r,(p,g)=>(l(),n("div",{class:w([{"h-10.75":!p,"bg-rose-900/50":g===d},"py-2 border-b last:border-b-0 border-zinc-700"])},b(p),3))),256))]))),256))],4),e("div",{class:"grid overflow-hidden",style:P(`grid-template-columns: repeat(${a.referenceStr.length}, minmax(0, 1fr));`)},[(l(!0),n(m,null,c(a.log,({isPageFault:r,victimPageFrameIdx:d})=>(l(),n("div",ae,[r?(l(),n("div",re,[i[4]||(i[4]=e("span",{class:"py-0.5 px-2 text-sm bg-rose-800 rounded-md"}," PF ",-1)),d+1?(l(),n("span",{key:0,class:w(["px-2 mt-2 rotate-180 rounded-md",s[d]]),style:{"writing-mode":"vertical-rl"}}," Frame "+b(String.fromCharCode(d+65))+" evicted ",3)):z("",!0)])):z("",!0)]))),256))],4)])])]),e("div",le,[e("div",ne,[i[5]||(i[5]=e("h4",{class:"h-24 font-medium",style:{"writing-mode":"vertical-rl"}},"Pages:",-1)),e("ul",oe,[(l(!0),n(m,null,c(a.referenceStr,r=>(l(),n("li",ie,b(r),1))),256))])]),e("div",de,[e("div",ue,[e("div",me,[(l(!0),n(m,null,c(a.frameCount,r=>(l(),n("div",ce,[e("h4",{class:w(["px-2 rounded-md max-h-max",s[r-1]])}," Frame "+b(String.fromCharCode(r+64))+": ",3)]))),256))]),e("div",pe,[e("div",ge,[(l(!0),n(m,null,c(a.log,({frames:r,victimPageFrameIdx:d})=>(l(),n("div",{class:"flex border-b border-zinc-700 last:border-0",style:P(`aspect-ratio: ${a.frameCount}/1`)},[(l(!0),n(m,null,c(r,(p,g)=>(l(),n("div",{class:w([{"bg-rose-900/50":g===d},"flex items-center justify-center w-10 border-r aspect-square last:border-0 border-zinc-700"])},b(p),3))),256))],4))),256))])])])]),e("div",fe,[(l(!0),n(m,null,c(a.log,({isPageFault:r})=>(l(),n("div",he,[r?(l(),n("span",be,"PF")):z("",!0)]))),256))])])]))}};class ye{constructor(s){I(this,"update",s=>{if(this.cache.includes(s)){const o=this.cache.indexOf(s);this.cache.splice(o,1)}else this.cache.pop();this.cache.unshift(s)});I(this,"getLruItem",()=>this.cache[this.size-1]);this.size=s,this.cache=new Array(s).fill(null)}}const ve={fifo:()=>{const a=[];return{update:s=>{a.includes(s)||a.push(s)},getVictimPage:()=>a.shift()}},lru:({frameCount:a})=>{const s=new ye(a);return{update:s.update,getVictimPage:s.getLruItem}},optimal:({frames:a,refStr:s})=>{let o=0;return{update:()=>{o++},getVictimPage:()=>{const r=a.map(g=>s.indexOf(g,o)),d=Math.max(...r),p=r.includes(-1)?r.indexOf(-1):r.indexOf(d);return a[p]}}}},we=(a,s,o)=>{const i=[];let r=0;const d=new Array(s).fill(null),p={refStr:a,frames:d,frameCount:s},g=ve[o],{update:A,getVictimPage:h}=g(p);for(const t of a){let f=!1,x;const v=d.findIndex(S=>S===null);if(!d.includes(t)){if(v>=0)d[v]=t;else{const S=h();x=d.findIndex(B=>B===S),d.splice(x,1,t)}r++,f=!0}A(t),i.push({frames:d.slice(),isPageFault:f,victimPageFrameIdx:x})}return{log:i,totalPageFaults:r}},Fe={class:"mb-10 space-y-4"},Ae={class:"mb-10 space-y-4"},Pe={class:"flex items-end gap-x-4"},Me={class:"flex flex-col flex-1 gap-y-2"},ke=["disabled"],Se={class:"space-y-4 overflow-x-auto"},Ie=["onUpdate:modelValue"],ze={class:"w-20 mx-auto text-center"},Ce=["onClick"],Oe={__name:"FirstInFirstOut",setup(a){const s=V({log:null,totalPageFaults:null}),o=V([1,2,3,4,2,1,5,2,4,5,3,5]),i=C(3),r=C(null),d=C(!1);N([o,i],()=>{d.value=!1});const p=()=>{const h=Math.round(Math.random()*9+1);o.push(h)},g=h=>{o.splice(h,1)},A=async()=>{if(!r.value.checkValidity())return r.value.reportValidity();d.value=!0;const{log:t,totalPageFaults:f}=we(o.slice(),i.value,"fifo");s.log=t,s.totalPageFaults=f};return(h,t)=>(l(),R(L,null,{[M($).howItWorks.id]:k(()=>[e("div",Fe,[t[4]||(t[4]=e("p",null,[u(" The "),e("span",{class:"text-main"},"First In First Out (FIFO)"),u(" is a "),e("span",{class:"text-main"},"page replacement algorithm"),u(" used in virtual memory management. Its purpose is to choose a suitable "),e("span",{class:"text-main"},"victim page"),u(" to swap with the requested page. ")],-1)),t[5]||(t[5]=e("h2",{class:"mt-10 text-xl font-semibold"}," Virtual Memory ",-1)),t[6]||(t[6]=e("hr",{class:"mb-4 border-neutral-800"},null,-1)),t[7]||(t[7]=e("p",null,[e("span",{class:"text-main"},"Virtual memory"),u(" is an abstraction of the physical memory (RAM), and is managed separately by the OS and the MMU (memory management unit). Processes only see the virtual memory, and think they have access to a large contiguous memory space. ")],-1)),t[8]||(t[8]=e("p",null," Virtual memory provides the illusion that there is more RAM than physically available on the computer, allowing the OS to run more processes than if only the RAM was available, by temporarily storing unused data on the hard disk. ",-1)),y(F,{src:"/algorithms/virtual-memory-management/virtual-memory.svg",class:"max-w-xl",caption:"Space Being Allocated to RAM From Secondary Memory"}),t[9]||(t[9]=e("p",null,[u(" Virtual memory is split into "),e("span",{class:"text-main"},"pages"),u(", each page typically worth around 4 KB of memory, and the RAM is split into "),e("span",{class:"text-main"},"frames"),u(", each frame being the same size as a page. Behind the curtains, the OS and MMU use a "),e("span",{class:"text-main"},"page table"),u(" for each process, to map each of their pages to a frame. ")],-1)),y(F,{src:"/algorithms/virtual-memory-management/page-to-frame-mapping.svg",class:"max-w-xl",caption:"How Pages Are Mapped to Frames"}),t[10]||(t[10]=e("p",null,[u(" Only the pages necessary for the process to run at the time are stored in the RAM, the rest are stored in the "),e("span",{class:"text-main"},"swap space"),u(" of the disk. This also occurs if there are more pages than there are free frames on the RAM. ")],-1)),t[11]||(t[11]=e("h2",{class:"mt-10 text-xl font-semibold"}," How Pages Are Accessed ",-1)),t[12]||(t[12]=e("hr",{class:"mb-4 border-neutral-800"},null,-1)),t[13]||(t[13]=e("p",null,[u(" When a process tries to access data in a certain page, it triggers the MMU to try and translate the "),e("span",{class:"text-main"},"virtual address"),u(" to a "),e("span",{class:"text-main"},"physical address"),u(" using the page table. If the page the process tried to access is currently mapped to a frame, then the translation occurs and access is granted immediately: ")],-1)),y(F,{src:"/algorithms/virtual-memory-management/successful-page-access.svg",class:"max-w-xl",caption:"An Example of How a Process Can Access Data in a Page"}),t[14]||(t[14]=e("h2",{class:"mt-10 text-xl font-semibold"}," Page Faults ",-1)),t[15]||(t[15]=e("hr",{class:"mb-4 border-neutral-800"},null,-1)),t[16]||(t[16]=e("p",null,[u(" A "),e("span",{class:"text-main"},"page fault"),u(" is when the MMU attempts to translate a virtual address into a physical address using a page table, however the respective page is not found in the page table. ")],-1)),t[17]||(t[17]=e("p",null," This means that the page is on the secondary storage and not in the RAM, so the MMU triggers a page fault, which is caught by the OS. The OS then proceeds to load the page into the RAM and update the page table, after which the process is repeated, but now with the page in memory. ",-1)),y(F,{src:"/algorithms/virtual-memory-management/page-fault.svg",class:"max-w-xl",caption:"An Example of a Page Fault and How It's Resolved"}),t[18]||(t[18]=e("h2",{class:"mt-10 text-xl font-semibold"}," How the FIFO Algorithm Works ",-1)),t[19]||(t[19]=e("hr",{class:"mb-4 border-neutral-800"},null,-1)),t[20]||(t[20]=e("p",null," Given that a page fault has occured, and there are no free frames available to load the requested page into, the OS runs a page replacement algorithm. In this case, the OS would run the first in first out algorithm. ",-1)),t[21]||(t[21]=e("p",null," The algorithm chooses a victim page and writes it to the disk, thus freeing up a frame in the RAM. The requested page is then loaded into the frame. ",-1)),t[22]||(t[22]=e("p",null," The FIFO algorithm keeps track of which pages entered a frame first using a queue, and then chooses the first item in the queue as the victim page. Here is an example with 4 pages and 3 frames: ",-1)),y(F,{src:"/algorithms/virtual-memory-management/fifo-algorithm.svg",class:"max-w-lg",caption:"How The FIFO Algorithm Works"})])]),[M($).visualizer.id]:k(()=>[e("div",Ae,[t[26]||(t[26]=e("h1",{class:"mb-4 text-xl font-semibold"}," Step By Step Illustration ",-1)),t[27]||(t[27]=e("hr",{class:"mb-4 border-neutral-800"},null,-1)),e("form",{class:"space-y-4",ref_key:"form",ref:r},[e("div",Pe,[e("div",Me,[t[23]||(t[23]=e("label",{class:"font-medium"},"Number of Frames:",-1)),O(e("input",{type:"number",class:"w-full field sm:w-60",min:"1",max:"5","onUpdate:modelValue":t[0]||(t[0]=f=>i.value=f)},null,512),[[q,i.value]])]),e("button",{type:"button",class:"btn",onClick:t[1]||(t[1]=f=>p()),disabled:o.length===12},"Add Row",8,ke)]),e("div",Se,[e("table",null,[t[24]||(t[24]=e("thead",null,[e("tr",null,[e("th",null,"Page ID"),e("th")])],-1)),e("tbody",null,[(l(!0),n(m,null,c(o,(f,x)=>(l(),n("tr",null,[e("td",null,[O(e("input",{type:"number",min:"1",max:"10","onUpdate:modelValue":v=>o[x]=v},null,8,Ie),[[q,o[x]]])]),e("td",ze,[e("div",{class:"flex items-center justify-center duration-100 border border-transparent rounded-md cursor-pointer bg-zinc-700 aspect-square w-7 group hover:border-rose-600 active:translate-y-1",onClick:v=>g(x)},[y(M(H),{class:"text-rose-500",tag:"span",size:"20px"},{default:k(()=>[y(M(W))]),_:1})],8,Ce)])]))),256))])]),e("button",{type:"submit",class:"btn",onClick:t[2]||(t[2]=T(f=>A(),["prevent"]))},"Run Algorithm")])],512),t[28]||(t[28]=e("h2",{class:"mt-10 text-xl font-semibold"}," Results ",-1)),t[29]||(t[29]=e("hr",{class:"mb-4 border-neutral-800"},null,-1)),d.value?(l(),R(xe,{key:0,"frame-count":i.value,log:s.log,"reference-str":o,"total-page-faults":s.totalPageFaults},null,8,["frame-count","log","reference-str","total-page-faults"])):(l(),R(D,{key:1},{default:k(()=>[t[25]||(t[25]=e("p",{class:"mb-4"}," No results to display yet, try running the algorithm... ",-1)),e("button",{onClick:t[3]||(t[3]=T(()=>A(h.parameters),["prevent"])),class:"btn"}," Run Algorithm ")]),_:1,__:[25]}))])]),_:2},1024))}};export{Oe as default};
