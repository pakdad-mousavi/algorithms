import{_ as k}from"./Alert-D_laTbTA.js";import{h as n,o as l,e as g,m as x,j as d,q as v,n as B,c as z,k as y,b as h,E as w,F as b,i as _,l as $,d as M}from"./index-DRS7tVTz.js";const F={class:"text-center"},j={key:0},A={class:"font-medium"},q={key:1,class:"font-medium"},N={__name:"MemoryBlock",props:{memoryBlock:{type:Object,required:!0},totalMemory:{type:Number,required:!0}},setup(t){const r=e=>e.status==="allocated"?o[e.pid-1]:"border-zinc-700",o=["bg-[image:repeating-linear-gradient(315deg,var(--color-cyan-600)_0,var(--color-cyan-600)_1px,_transparent_1px,_transparent_50%)] border-cyan-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-emerald-600)_0,var(--color-emerald-600)_1px,_transparent_1px,_transparent_50%)] border-emerald-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-yellow-500)_0,var(--color-yellow-500)_1px,_transparent_1px,_transparent_50%)] border-yellow-500 border","bg-[image:repeating-linear-gradient(315deg,var(--color-rose-600)_0,var(--color-rose-600)_1px,_transparent_1px,_transparent_50%)] border-rose-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-amber-600)_0,var(--color-amber-600)_1px,_transparent_1px,_transparent_50%)] border-amber-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-violet-600)_0,var(--color-violet-600)_1px,_transparent_1px,_transparent_50%)] border-violet-600 border"];return(e,s)=>(l(),n("div",{class:B(["flex items-center justify-center h-full border-x bg-[size:10px_10px] last:border-r-0",r(t.memoryBlock)]),style:v(`width: ${t.memoryBlock.size/t.totalMemory*100}%`)},[g("p",F,[t.memoryBlock.status==="allocated"?(l(),n("span",j,[x(" P"+d(t.memoryBlock.pid)+": ",1),g("span",A,d(t.memoryBlock.size)+"KB",1)])):(l(),n("span",q,d(t.memoryBlock.status[0].toUpperCase()+t.memoryBlock.status.slice(1))+": "+d(t.memoryBlock.size)+"KB ",1))])],6))}},R={class:"flex items-center justify-center w-12 h-full bg-zinc-800"},S={key:0},C={key:1},P={__name:"ActionCode",props:{currentAction:{type:Object,required:!0}},setup(t){return(r,o)=>(l(),n("div",R,[t.currentAction.isAllocation?(l(),n("span",S,"A"+d(t.currentAction.pid),1)):(l(),n("span",C,"D"+d(t.currentAction.pid),1))]))}},V={key:0,class:"overflow-x-scroll"},L={class:"flex flex-col gap-y-0.5 overflow-hidden border rounded-md min-w-xl border-zinc-700"},T={__name:"Memory",props:{hasAlgorithmBeenRan:{type:Boolean,required:!0},totalMemory:{type:Number,required:!0},algResult:{type:Object,required:!0},actions:{type:Array,default:()=>[]}},setup(t){const r=t,o=z(()=>{const e=r.actions[r.algResult.memoryLog.length];return e!=null&&e.isAllocation?`Failed to allocate memory to process P${e==null?void 0:e.pid}, not enough memory or memory has already been allocated to this process. Try increasing the total memory, requesting for less memory, or allocating memory to the process once.`:`Failed to deallocate memory from process P${e==null?void 0:e.pid}, process could not be found in memory. Make sure that P${e==null?void 0:e.pid} has been allocated before trying to deallocate it.`});return(e,s)=>(l(),n(b,null,[t.hasAlgorithmBeenRan?(l(),n("div",V,[s[0]||(s[0]=w('<div class="min-w-xl"><div class="w-[calc(100%-48px)] ml-12 text-center relative"><span class="mb-2 block">Memory</span><div class="mb-6 border-b-2 border-zinc-600"></div><div class="absolute h-4 border border-zinc-600 -bottom-4"></div><div class="absolute h-4 border border-zinc-600 right-0 -bottom-4"></div></div></div>',1)),g("div",L,[(l(!0),n(b,null,_(t.algResult.memoryLog,(a,c)=>(l(),n("div",{key:c,class:"border-y border-zinc-700 first:border-t-0 last:border-b-0 flex items-center justify-center w-full h-12 gap-x-0.5"},[$(P,{"current-action":t.actions[c]},null,8,["current-action"]),(l(!0),n(b,null,_(a,(i,m)=>(l(),h(N,{key:m,"memory-block":i,"total-memory":t.totalMemory},null,8,["memory-block","total-memory"]))),128))]))),128))])])):y("",!0),t.hasAlgorithmBeenRan&&!t.algResult.isSuccessful?(l(),h(k,{key:1,"alert-style":"error"},{default:M(()=>[g("p",null,d(o.value),1)]),_:1})):y("",!0)],64))}},f={firstFit:(t,r)=>{for(let o=0;o<r.length;o++){const e=r[o];if(e.status==="free"&&e.size>=t)return[o,e]}return[r.length,!1]},bestFit:(t,r)=>{let o=-1,e=null;for(let s=0;s<r.length;s++){const a=r[s];a.status==="free"&&a.size>=t&&(!e||a.size<e.size)&&(e=a,o=s)}return e?[o,e]:[r.length,!1]},worstFit:(t,r)=>{let o=-1,e=null;for(let s=0;s<r.length;s++){const a=r[s];a.status==="free"&&a.size>=t&&(!e||a.size>e.size)&&(e=a,o=s)}return e?[o,e]:[r.length,!1]}},O=(t,r,o,e)=>{const s=new Set(o.filter(u=>u.status==="allocated").map(u=>u.pid)),a=f==null?void 0:f[e],[c,i]=a(r,o);if(!i||s.has(t))return!1;const m={start:i.start,size:r,status:"allocated",pid:t},p=i.size-r;if(p){const u={start:i.start+r,size:p,status:"free"};o.splice(c,1,m,u)}else o[c]=m;return!0},D=(t,r)=>{for(let o=0;o<r.length;o++)if(r[o].status==="allocated"&&r[o].pid===t)return r[o]={start:r[o].start,size:r[o].size,status:"free"},E(r),!0;return!1},E=t=>{for(let r=0;r<t.length-1;r++){const o=t[r],e=t[r+1];o.status==="free"&&e.status==="free"&&(t[r].size+=e.size,t.splice(r+1,1),r--)}},U=(t,r,o)=>{const e=[],s=[];let a=!0;e.push({start:0,size:r,status:"free"});for(const c of t)if(c.isAllocation?a=O(c.pid,c.size,e,o):a=D(c.pid,e),a)s.push(e.map(i=>({...i})));else break;return{isSuccessful:a,memoryLog:s}};export{T as _,U as r};
