import{e as c,o as a,g as t,i as w,t as p,p as T,n as R,c as j,f as x,b as _,B as D,F as B,l as M,h as b,d as F,r as A,a as V,w as K,T as U,j as k,v as P,C as q,u as C,I as L,k as I}from"./index-B2qxMY-B.js";import{_ as N}from"./Alert-BAUpADdf.js";import{_ as z,T as E,a as H}from"./Figure-KKT11UNX.js";const O={class:"text-center"},W={key:0},G={class:"font-medium"},J={key:1,class:"font-medium"},Q={__name:"MemoryBlock",props:{memoryBlock:{type:Object,required:!0},totalMemory:{type:Number,required:!0}},setup(s){const o=r=>r.status==="allocated"?l[r.pid-1]:"border-zinc-700",l=["bg-[image:repeating-linear-gradient(315deg,var(--color-cyan-600)_0,var(--color-cyan-600)_1px,_transparent_1px,_transparent_50%)] border-cyan-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-emerald-600)_0,var(--color-emerald-600)_1px,_transparent_1px,_transparent_50%)] border-emerald-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-yellow-500)_0,var(--color-yellow-500)_1px,_transparent_1px,_transparent_50%)] border-yellow-500 border","bg-[image:repeating-linear-gradient(315deg,var(--color-rose-600)_0,var(--color-rose-600)_1px,_transparent_1px,_transparent_50%)] border-rose-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-amber-600)_0,var(--color-amber-600)_1px,_transparent_1px,_transparent_50%)] border-amber-600 border","bg-[image:repeating-linear-gradient(315deg,var(--color-violet-600)_0,var(--color-violet-600)_1px,_transparent_1px,_transparent_50%)] border-violet-600 border"];return(r,i)=>(a(),c("div",{class:R(["flex items-center justify-center h-full border-x bg-[size:10px_10px] last:border-r-0",o(s.memoryBlock)]),style:T(`width: ${s.memoryBlock.size/s.totalMemory*100}%`)},[t("p",O,[s.memoryBlock.status==="allocated"?(a(),c("span",W,[w(" P"+p(s.memoryBlock.pid)+": ",1),t("span",G,p(s.memoryBlock.size)+"KB",1)])):(a(),c("span",J,p(s.memoryBlock.status[0].toUpperCase()+s.memoryBlock.status.slice(1))+": "+p(s.memoryBlock.size)+"KB ",1))])],6))}},X={class:"flex items-center justify-center w-12 h-full bg-zinc-800"},Y={key:0},Z={key:1},ee={__name:"ActionCode",props:{currentAction:{type:Object,required:!0}},setup(s){return(o,l)=>(a(),c("div",X,[s.currentAction.isAllocation?(a(),c("span",Y,"A"+p(s.currentAction.pid),1)):(a(),c("span",Z,"D"+p(s.currentAction.pid),1))]))}},te={key:0,class:"overflow-x-scroll"},se={class:"flex flex-col gap-y-0.5 overflow-hidden border rounded-md min-w-xl border-zinc-700"},re={__name:"Memory",props:{hasAlgorithmBeenRan:{type:Boolean,required:!0},totalMemory:{type:Number,required:!0},algResult:{type:Object,required:!0},actions:{type:Array,default:()=>[]}},setup(s){const o=s,l=j(()=>{const r=o.actions[o.algResult.memoryLog.length];return r!=null&&r.isAllocation?`Failed to allocate memory to process P${r==null?void 0:r.pid}, not enough memory or memory has already been allocated to this process. Try increasing the total memory, requesting for less memory, or allocating memory to the process once.`:`Failed to deallocate memory from process P${r==null?void 0:r.pid}, process could not be found in memory. Make sure that P${r==null?void 0:r.pid} has been allocated before trying to deallocate it.`});return(r,i)=>(a(),c(B,null,[s.hasAlgorithmBeenRan?(a(),c("div",te,[i[0]||(i[0]=D('<div class="min-w-xl"><div class="w-[calc(100%-48px)] ml-12 text-center relative"><span class="mb-2 block">Memory</span><div class="mb-6 border-b-2 border-zinc-600"></div><div class="absolute h-4 border border-zinc-600 -bottom-4"></div><div class="absolute h-4 border border-zinc-600 right-0 -bottom-4"></div></div></div>',1)),t("div",se,[(a(!0),c(B,null,M(s.algResult.memoryLog,(u,d)=>(a(),c("div",{key:d,class:"border-y border-zinc-700 first:border-t-0 last:border-b-0 flex items-center justify-center w-full h-12 gap-x-0.5"},[b(ee,{"current-action":s.actions[d]},null,8,["current-action"]),(a(!0),c(B,null,M(u,(f,y)=>(a(),_(Q,{key:y,"memory-block":f,"total-memory":s.totalMemory},null,8,["memory-block","total-memory"]))),128))]))),128))])])):x("",!0),s.hasAlgorithmBeenRan&&!s.algResult.isSuccessful?(a(),_(N,{key:1,"alert-style":"error"},{default:F(()=>[t("p",null,p(l.value),1)]),_:1})):x("",!0)],64))}},$={firstFit:(s,o)=>{for(let l=0;l<o.length;l++){const r=o[l];if(r.status==="free"&&r.size>=s)return[l,r]}return[o.length,!1]},bestFit:()=>{},worstFit:()=>{}},oe=(s,o,l,r)=>{const i=new Set(l.filter(e=>e.status==="allocated").map(e=>e.pid)),u=$==null?void 0:$[r],[d,f]=u(o,l);if(!f||i.has(s))return!1;const y={start:f.start,size:o,status:"allocated",pid:s},g=f.size-o;if(g){const e={start:f.start+o,size:g,status:"free"};l.splice(d,1,y,e)}else l[d]=y;return!0},le=(s,o)=>{for(let l=0;l<o.length;l++)if(o[l].status==="allocated"&&o[l].pid===s)return o[l]={start:o[l].start,size:o[l].size,status:"free"},ae(o),!0;return!1},ae=s=>{for(let o=0;o<s.length-1;o++){const l=s[o],r=s[o+1];l.status==="free"&&r.status==="free"&&(s[o].size+=r.size,s.splice(o+1,1),o--)}},ne=(s,o,l)=>{const r=[],i=[];let u=!0;r.push({start:0,size:o,status:"free"});for(const d of s)if(d.isAllocation?u=oe(d.pid,d.size,r,l):u=le(d.pid,r),u)i.push(r.map(f=>({...f})));else break;return{isSuccessful:u,memoryLog:i}},ie={key:0,class:"mb-10 space-y-4"},ce={key:1,class:"mb-10 space-y-4"},me={class:"flex flex-wrap items-end gap-4"},de={class:"flex flex-col gap-2"},ue={class:"flex flex-col flex-1 gap-2"},fe={class:"flex gap-2"},pe=["disabled"],ye={class:"overflow-x-scroll"},ge=["onUpdate:modelValue"],be=["onUpdate:modelValue"],he=["value"],ve=["onUpdate:modelValue"],xe={class:"w-20 mx-auto text-center"},ke=["onClick"],Ae={__name:"FirstFit",props:{tab:{type:String,required:!0}},setup(s){const o=A(null),l=A(4),r=A(100),i=V([{isAllocation:!0,pid:1,size:40},{isAllocation:!0,pid:2,size:20},{isAllocation:!0,pid:3,size:25},{isAllocation:!1,pid:2}]),u=V({isSuccessful:!1,memoryLog:[]}),d=A(!1);K([i,r],()=>{d.value=!1});const f=()=>{const g=l.value,e=new Set(i.filter(n=>n.isAllocation).map(n=>n.pid)),m=new Set(i.filter(n=>!n.isAllocation).map(n=>n.pid)),h=[...e].filter(n=>!m.has(n));if(e.size<g){let n=null;for(let v=1;v<=g;v++)if(!e.has(v)){n=v;break}const S={isAllocation:!0,pid:n,size:10};i.push(S)}else if(h.length>0){const n=Math.floor(Math.random()*h.length),v={isAllocation:!1,pid:h[n]};i.push(v)}},y=()=>{if(!o.value.checkValidity())return o.value.reportValidity();const{isSuccessful:e,memoryLog:m}=ne(i,r.value,"firstFit");u.isSuccessful=e,u.memoryLog=m,d.value=!0};return(g,e)=>(a(),_(U,null,{default:F(()=>[(a(),c("div",{key:s.tab},[s.tab==="How It Works"?(a(),c("div",ie,[e[3]||(e[3]=t("p",null,[w(" The "),t("span",{class:"text-main"},"First Fit Algorithm"),w(" is a memory allocation strategy used in dynamic memory management. It's job is to manage free space in the main memory. ")],-1)),e[4]||(e[4]=t("p",null," As processes are ran by the CPU, they will request for certain amounts of memory, and the system needs to allocate this memory efficiently. The first fit algorithm's job is to find the very first empty block of memory which is big enough for the process's request. ",-1)),e[5]||(e[5]=t("h2",{class:"mt-10 text-xl font-semibold"}," External Fragmentation ",-1)),e[6]||(e[6]=t("hr",{class:"mb-4 border-neutral-800"},null,-1)),e[7]||(e[7]=t("p",null," Lets say we have a block of empty memory, like so: ",-1)),b(z,{src:"/algorithms/memory-management/first-fit/empty-memory.svg",caption:"Empty Memory",class:"max-w-2xl"}),e[8]||(e[8]=t("p",null," As processes arrive in the CPU, the system needs to allocate free memory to each process. Let's say we have 3 processes, P1, P2, and P3, each requesting 50KB, 50KB, and 80KB worth of memory respectively: ",-1)),b(z,{src:"/algorithms/memory-management/first-fit/memory-allocation.svg",class:"max-w-lg",caption:"Allocating Memory for P1, P2, and P3"}),e[9]||(e[9]=t("p",null,[w(" When a process finishes executing, the memory allocated to it earlier becomes free. However, the freed memory block may not be connected to other free memory blocks, resulting in "),t("span",{class:"text-main"},"external fragmentation"),w(", like so: ")],-1)),b(z,{src:"/algorithms/memory-management/first-fit/external-fragmentation.svg",class:"max-w-lg",caption:"External Fragmentation"}),e[10]||(e[10]=t("h2",{class:"mt-10 text-xl font-semibold"}," How It Works ",-1)),e[11]||(e[11]=t("hr",{class:"mb-4 border-neutral-800"},null,-1)),e[12]||(e[12]=t("p",null," The first fit algorithm becomes useful when a process requests memory, and the memory is fragmented. Its job is to find the first block of memory large enough to fit the request. For example, if there are three empty blocks of memory, each worth 20KB, 50KB, and 40KB of space respectively, the 50KB block would be chosen: ",-1)),b(z,{src:"/algorithms/memory-management/first-fit/first-fit-algorithm.svg",class:"max-w-2xl",caption:"How the First Fit Algorithm Chooses a Memory Block"})])):x("",!0),s.tab==="Algorithm Visualizer"?(a(),c("div",ce,[e[18]||(e[18]=t("h2",{class:"text-xl font-semibold"}," Step by Step Illustration ",-1)),e[19]||(e[19]=t("hr",{class:"mb-4 border-neutral-800"},null,-1)),t("form",{class:"space-y-4",ref_key:"form",ref:o},[t("div",me,[t("div",de,[e[13]||(e[13]=t("label",{class:"font-medium"},"Number of Processes:",-1)),k(t("input",{type:"number",class:"w-full field sm:w-60",min:"1",max:"6",required:"","onUpdate:modelValue":e[0]||(e[0]=m=>l.value=m)},null,512),[[P,l.value]])]),t("div",ue,[e[14]||(e[14]=t("label",{class:"font-medium"},"Total Memory Size (KB):",-1)),k(t("input",{type:"number",class:"w-full field sm:w-60",min:"10",max:"150",required:"","onUpdate:modelValue":e[1]||(e[1]=m=>r.value=m)},null,512),[[P,r.value]])]),t("div",fe,[t("button",{class:R(["btn",{disabled:i.length===12}]),type:"button",onClick:e[2]||(e[2]=m=>f()),disabled:i.length===12}," Add Row ",10,pe)])]),t("div",ye,[t("table",null,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"Action Type"),t("th",null,"Process ID"),t("th",null,"Size (KB)"),t("th")])],-1)),t("tbody",null,[(a(!0),c(B,null,M(i,(m,h)=>(a(),c("tr",{key:h},[t("td",null,[k(t("select",{"onUpdate:modelValue":n=>m.isAllocation=n},e[15]||(e[15]=[t("option",{value:!0},"Allocation",-1),t("option",{value:!1},"Deallocation",-1)]),8,ge),[[q,m.isAllocation]])]),t("td",null,[k(t("select",{"onUpdate:modelValue":n=>m.pid=n},[(a(!0),c(B,null,M(l.value,n=>(a(),c("option",{value:n},p(n),9,he))),256))],8,be),[[q,m.pid]])]),t("td",null,[m.isAllocation?k((a(),c("input",{key:0,min:"10",type:"number","onUpdate:modelValue":n=>m.size=n},null,8,ve)),[[P,m.size]]):x("",!0)]),t("td",xe,[i.length>1?(a(),c("div",{key:0,class:"flex items-center justify-center duration-100 border border-transparent rounded-md cursor-pointer bg-zinc-700 aspect-square w-7 group hover:border-rose-600 active:translate-y-1",onClick:n=>i.splice(h,1)},[b(C(L),{class:"text-rose-500",tag:"span",size:"20px"},{default:F(()=>[b(C(E))]),_:1})],8,ke)):x("",!0)])]))),128))])])]),t("button",{type:"submit",class:"btn",onClick:I(y,["prevent"])},"Run Algorithm")],512),e[20]||(e[20]=t("h2",{class:"mt-10 text-xl font-semibold"}," Results ",-1)),e[21]||(e[21]=t("hr",{class:"mb-4 border-neutral-800"},null,-1)),d.value?(a(),_(re,{key:0,"has-algorithm-been-ran":d.value,"total-memory":r.value,"alg-result":u,actions:i},null,8,["has-algorithm-been-ran","total-memory","alg-result","actions"])):(a(),_(H,{key:1},{default:F(()=>[e[17]||(e[17]=t("p",{class:"mb-4"}," No results to display yet, try running the algorithm... ",-1)),t("button",{onClick:I(y,["prevent"]),class:"btn"}," Run Algorithm ")]),_:1}))])):x("",!0)]))]),_:1}))}};export{Ae as default};
