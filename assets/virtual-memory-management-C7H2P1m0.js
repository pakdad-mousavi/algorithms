var C=Object.defineProperty;var S=(e,r,i)=>r in e?C(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i;var y=(e,r,i)=>S(e,typeof r!="symbol"?r+"":r,i);import{c as l,o as n,a as t,J as V,t as m,B as g,F as a,j as c,A as x,y as v}from"./index-Nx0vkye7.js";const j={class:"flex flex-col w-full pb-2 space-y-4 overflow-x-scroll"},q={class:"flex flex-wrap justify-center gap-4 sm:justify-normal"},I={class:"px-2 py-1 border rounded-md bg-zinc-800 border-zinc-700 max-w-max"},k={class:"font-medium"},A={class:"hidden sm:block min-w-xl"},N={class:"flex items-center mb-4"},B={class:"py-2 font-bold border-r border-zinc-700 last:border-0"},L={class:"flex mb-2"},O={class:"w-1/6 border-transparent border-y"},$={class:"py-2 space-y-2 font-medium border-b border-transparent"},T={class:"w-5/6"},R={class:"border-r border-zinc-700 last:border-0"},D={class:"mx-auto"},E={key:0,class:"flex flex-col items-center font-medium"},J={class:"flex justify-center w-full gap-x-4 sm:hidden"},M={class:"flex flex-col items-center mb-4"},U={class:"text-center border rounded-md border-zinc-700"},G={class:"flex items-center justify-center w-10 font-bold border-b aspect-square border-zinc-700 last:border-0"},H={class:"flex flex-col items-center mb-4"},K={class:"flex flex-col mb-2"},Q={class:"flex justify-around w-full h-24"},W={class:"font-medium",style:{"writing-mode":"vertical-rl"}},X={class:"flex"},Y={class:"mb-4 overflow-hidden text-center border rounded-md border-zinc-700"},Z={class:"flex flex-col mt-24"},ee={class:"flex items-center h-10 font-medium"},te={key:0,class:"py-0.5 px-2 text-sm bg-rose-800 rounded-md"},oe={__name:"RefStringTracer",props:{frameCount:{type:Number,required:!0},totalPageFaults:{type:Number,required:!0},referenceStr:{type:Array,required:!0},log:{type:Array,required:!0}},setup(e){const r=["bg-yellow-600 text-zinc-900","bg-emerald-700","bg-blue-900","bg-amber-700","bg-purple-700"];return(i,d)=>(n(),l("div",j,[t("div",q,[d[2]||(d[2]=t("div",{class:"sm:flex-1"},[t("p",{class:"px-2 py-1 border rounded-md bg-zinc-800 border-zinc-700 max-w-max"},[t("span",{class:"py-0.5 px-2 text-sm bg-rose-800 rounded-md"},"PF"),t("span",null,": Page Fault")]),t("p")],-1)),t("div",I,[t("p",null,[d[0]||(d[0]=V("Total Page Faults: ")),t("span",k,m(e.totalPageFaults),1)]),d[1]||(d[1]=t("p",null,null,-1))])]),t("div",A,[t("div",N,[d[3]||(d[3]=t("h4",{class:"w-1/6 font-medium"},"Pages:",-1)),t("ul",{class:"grid w-5/6 text-center border rounded-md border-zinc-700",style:g(`grid-template-columns: repeat(${e.referenceStr.length}, minmax(0, 1fr));`)},[(n(!0),l(a,null,c(e.referenceStr,s=>(n(),l("li",B,m(s),1))),256))],4)]),t("div",L,[t("div",O,[(n(!0),l(a,null,c(e.frameCount,s=>(n(),l("div",$,[t("h4",{class:x(["px-2 rounded-md max-w-max",r[s-1]])}," Frame "+m(String.fromCharCode(s+64))+": ",3)]))),256))]),t("div",T,[t("div",{class:"grid mb-4 overflow-hidden text-center border rounded-md border-zinc-700",style:g(`grid-template-columns: repeat(${e.referenceStr.length}, minmax(0, 1fr));`)},[(n(!0),l(a,null,c(e.log,({frames:s,victimPageFrameIdx:o})=>(n(),l("div",R,[(n(!0),l(a,null,c(s,(u,f)=>(n(),l("div",{class:x([{"h-10.75":!u,"bg-rose-900/50":f===o},"py-2 border-b last:border-b-0 border-zinc-700"])},m(u),3))),256))]))),256))],4),t("div",{class:"grid overflow-hidden",style:g(`grid-template-columns: repeat(${e.referenceStr.length}, minmax(0, 1fr));`)},[(n(!0),l(a,null,c(e.log,({isPageFault:s,victimPageFrameIdx:o})=>(n(),l("div",D,[s?(n(),l("div",E,[d[4]||(d[4]=t("span",{class:"py-0.5 px-2 text-sm bg-rose-800 rounded-md"}," PF ",-1)),o+1?(n(),l("span",{key:0,class:x(["px-2 mt-2 rotate-180 rounded-md",r[o]]),style:{"writing-mode":"vertical-rl"}}," Frame "+m(String.fromCharCode(o+65))+" evicted ",3)):v("",!0)])):v("",!0)]))),256))],4)])])]),t("div",J,[t("div",M,[d[5]||(d[5]=t("h4",{class:"h-24 font-medium",style:{"writing-mode":"vertical-rl"}},"Pages:",-1)),t("ul",U,[(n(!0),l(a,null,c(e.referenceStr,s=>(n(),l("li",G,m(s),1))),256))])]),t("div",H,[t("div",K,[t("div",Q,[(n(!0),l(a,null,c(e.frameCount,s=>(n(),l("div",W,[t("h4",{class:x(["px-2 rounded-md max-h-max",r[s-1]])}," Frame "+m(String.fromCharCode(s+64))+": ",3)]))),256))]),t("div",X,[t("div",Y,[(n(!0),l(a,null,c(e.log,({frames:s,victimPageFrameIdx:o})=>(n(),l("div",{class:"flex border-b border-zinc-700 last:border-0",style:g(`aspect-ratio: ${e.frameCount}/1`)},[(n(!0),l(a,null,c(s,(u,f)=>(n(),l("div",{class:x([{"bg-rose-900/50":f===o},"flex items-center justify-center w-10 border-r aspect-square last:border-0 border-zinc-700"])},m(u),3))),256))],4))),256))])])])]),t("div",Z,[(n(!0),l(a,null,c(e.log,({isPageFault:s})=>(n(),l("div",ee,[s?(n(),l("span",te,"PF")):v("",!0)]))),256))])])]))}};class re{constructor(r){y(this,"update",r=>{if(this.cache.includes(r)){const i=this.cache.indexOf(r);this.cache.splice(i,1)}else this.cache.pop();this.cache.unshift(r)});y(this,"getLruItem",()=>this.cache[this.size-1]);this.size=r,this.cache=new Array(r).fill(null)}}const se={fifo:()=>{const e=[];return{update:r=>{e.includes(r)||e.push(r)},getVictimPage:()=>e.shift()}},lru:({frameCount:e})=>{const r=new re(e);return{update:r.update,getVictimPage:r.getLruItem}},optimal:({frames:e,refStr:r})=>{let i=0;return{update:()=>{i++},getVictimPage:()=>{const s=e.map(f=>r.indexOf(f,i)),o=Math.max(...s),u=s.includes(-1)?s.indexOf(-1):s.indexOf(o);return e[u]}}}},de=(e,r,i)=>{const d=[];let s=0;const o=new Array(r).fill(null),u={refStr:e,frames:o,frameCount:r},f=se[i],{update:z,getVictimPage:P}=f(u);for(const b of e){let w=!1,h;const _=o.findIndex(p=>p===null);if(!o.includes(b)){if(_>=0)o[_]=b;else{const p=P();h=o.findIndex(F=>F===p),o.splice(h,1,b)}s++,w=!0}z(b),d.push({frames:o.slice(),isPageFault:w,victimPageFrameIdx:h})}return{log:d,totalPageFaults:s}};export{oe as _,de as r};
